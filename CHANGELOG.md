# Changelog

## 2024-12-24
- **NEW FEATURE**: Batch Processing Mode for Sales Rank Analyzer
  - Added dual processing mode support: Single ASIN and Batch Processing
  - Implemented batch mode with text widget for entering multiple ASINs (comma, space, or newline separated)
  - Added "Load All Saved ASINs" and "Load from List" quick-load buttons for batch input
  - Batch mode allows analyzing sales rank for multiple products in one operation
  - Matches the batch processing capabilities already available in Buybox Analyzer
- **NEW FEATURE**: ASIN Input Mode Selection for Single Mode
  - Added ASIN input mode radio buttons (Manual Input vs. Select from List)
  - Manual mode allows direct ASIN entry with validation
  - Select mode provides dropdown of saved ASINs for quick selection
  - Combobox automatically populated with all saved ASINs from ASIN Manager
  - Dynamic UI switching between manual entry and dropdown selection
- **NEW FEATURE**: Progress Tracking for Batch Operations
  - Implemented visual progress window during batch processing
  - Displays progress bar showing completion percentage
  - Shows current ASIN being processed (e.g., "Processing ASIN 5/20: B00EXAMPLE")
  - Real-time status updates as each ASIN is analyzed
  - Centered progress window for better visibility
- **NEW FEATURE**: Enhanced Results Display for Batch Mode
  - Different output formatting for single vs. batch processing
  - Batch results show ASIN, product title, category, and statistics for each product
  - Results grouped by ASIN with clear separators for readability
  - Displays comprehensive summary: total ASINs processed, success count, and error count
  - Error section at bottom lists all failed ASINs with specific error messages
  - Window sizing optimized: 95% screen size for batch, 70% for single ASIN
- **NEW FEATURE**: CSV Export for Batch Results
  - Enhanced CSV export to handle multiple ASIN results in single file
  - Export includes ASIN, title, category name, category ID, and all statistics
  - Summary columns: days_analyzed, data_points, rank_changes, average_rank, min_rank, max_rank
  - Export confirmation shows count of processed ASINs and any errors
  - Maintains compatibility with single ASIN CSV export format
- **UI IMPROVEMENTS**: Dynamic Interface Enhancements
  - Processing mode selection with radio buttons (Single ASIN / Batch Processing)
  - Dynamic window resizing: 600x600 for single mode, 700x700 for batch mode
  - UI elements show/hide based on selected mode for cleaner interface
  - Batch frame with labeled border and integrated quick-load buttons
  - Larger input window (700x600) to accommodate new options
  - Maintained consistent design patterns with Buybox Analyzer interface
- **CODE QUALITY**: Architectural Improvements
  - Added `process_single_asin()` helper method for clean separation of concerns
  - Returns `(result_dict, error)` tuple for consistent error handling
  - Method now accepts list of ASINs instead of single ASIN for unified interface
  - Extracted single ASIN processing logic for reuse in both modes
  - Enhanced error handling with specific error messages per ASIN
  - Updated `run_sales_rank_analyzer()` in main app to handle new return format
  - Added imports for ASIN management functions (validate_asin, validate_asin_list, etc.)
  - Maintained backward compatibility with existing functionality
- **CODE QUALITY**: Result Structure Enhancement
  - Created comprehensive result dictionary with all analysis data
  - Includes ASIN, title, category info, statistics, and raw DataFrame
  - Enables batch processing without code duplication
  - Facilitates CSV export with consistent data structure
  - Improved result aggregation and error tracking
- **USER EXPERIENCE**: Completion Messages
  - Different completion messages for single vs. batch mode
  - Batch completion shows total ASIN count processed
  - Clear feedback on operation success or failure
  - Integration with main menu return workflow

## 2025-12-24
- **BUG FIX**: Fixed Sales Rank Category Selection Logic
  - Replaced scoring-based category selection with categoryTree-based selection
  - Now correctly selects the most specific (deepest) category from the categoryTree hierarchy
  - Uses the last item in categoryTree as the target category (most specific subcategory)
  - Fixed issue where incorrect category was being selected, causing "no results available" errors
  - Added fallback mechanism if target category not found in salesRanks data
  - Improved category matching to handle both string and integer category IDs
- **NEW FEATURE**: Category Name Display in Sales Rank Results
  - Added category name and ID display in sales rank analysis results
  - Shows the selected category name (e.g., "9V") and category ID in the output
  - Helps users understand which category's sales rank data is being analyzed
  - Category name extracted from categoryTree for accurate display
- **DEBUGGING IMPROVEMENTS**: Enhanced Sales Rank Analyzer Debugging
  - Added verbose mode to SalesRankAnalyzer class for detailed step-by-step debugging
  - Implemented `_debug_print()` method for conditional debug output
  - Added comprehensive debug logging throughout `parse_sales_rank_history()` method
  - Debug output shows category tree traversal, category selection process, and data parsing details
  - Added date range analysis in `calculate_sales_rank_stats()` to identify filtering issues
  - Created `debug_sales_rank.py` standalone script for troubleshooting sales rank issues
  - Debug script provides step-by-step analysis with detailed output for each processing stage
- **CODE QUALITY**: Improved category selection architecture
  - Maintained backward compatibility with existing functionality
  - Enhanced error handling for edge cases (missing categoryTree, category not in salesRanks)
  - Added category name lookup dictionary for efficient name resolution
  - Improved code documentation explaining category selection logic

## 2025-12-24
- **NEW FEATURE**: Sales Rank Debugging in Debug Mode
  - Extended Debug Mode to support Sales Rank Analyzer debugging alongside Buybox Analyzer
  - Added `fetch_sales_rank_data()` method to fetch and analyze sales rank data from Keepa API
  - Implemented comprehensive data source inspection for both `salesRanks` field (category-specific) and `csv[3]` field (main sales rank)
  - Created intelligent date range analysis to identify why "no results available" occurs
  - Added record counting for total data vs. data within requested time period
  - Implemented category information extraction and display
- **NEW FEATURE**: Diagnostic Summary for Sales Rank Troubleshooting
  - Added dedicated "üîç Diagnostic Summary" tab with comprehensive problem diagnosis
  - Displays date range analysis showing cutoff dates and available data ranges
  - Shows category breakdown with record counts for each sales rank category
  - Provides clear warnings when data exists but falls outside requested period
  - Includes actionable tips and solutions (e.g., "Try increasing the 'Days to analyze' value")
  - Generates clear diagnosis explaining exactly why "no results available" appears
- **NEW FEATURE**: Enhanced Debug Mode UI
  - Added debug type selection (Buybox Analyzer vs. Sales Rank Analyzer)
  - Added "Days to analyze" input field for sales rank debugging (dynamically shown/hidden)
  - Updated window sizing to accommodate new options (750px height)
  - Maintained consistent UI patterns with existing debug functionality
- **NEW FEATURE**: Sample Data Tab for Sales Rank Debugging
  - Added "üìã Sample Data" tab showing actual rank values from available data sources
  - Displays most recent records from each category and main sales rank
  - Helps users verify data quality and understand data structure
- **DEBUGGING IMPROVEMENTS**: Enhanced troubleshooting capabilities
  - Identifies when sales rank data exists but is older than requested period
  - Distinguishes between "no data available" vs. "data outside period" scenarios
  - Provides specific guidance based on diagnosis (increase days, check date ranges, etc.)
  - Shows both total records and records within period for each data source
  - Displays earliest and latest dates for available data to help users adjust their queries
- **CODE QUALITY**: Maintained architecture principles
  - Extended DebugViewer class with sales rank methods following existing patterns
  - Maintained Single Responsibility Principle with separate display methods
  - Added comprehensive error handling for API failures and data parsing issues
  - Implemented consistent data structure returns matching existing debug functionality
  - Enhanced code documentation with detailed method descriptions

## 2025-11-07
- **NEW FEATURE**: Current Buybox Owners Lookup Tool
  - Added new "Current Buybox Owners" feature to fetch real-time buybox ownership data
  - Implemented `get_current_buybox_owner()` method to retrieve current owner for any ASIN
  - Returns current owner ID, owner type (Amazon/3rd Party), last update timestamp, and product title
  - Created dedicated input interface with single and batch processing modes
  - Added support for loading ASINs from saved lists or manual entry
  - Implemented tabular results display showing all ownership details at a glance
  - Added CSV export functionality for current owner data
  - Integrated progress tracking for batch owner lookups
- **NEW FEATURE**: ASIN Manager as Standalone Tool
  - Added "ASIN Manager" button to main menu for easy access
  - Created standalone ASIN Manager window (900x700) with enhanced functionality
  - Organized interface with four tabs: Add ASINs, Manage Lists, Edit List, and All ASINs
  - Implemented comprehensive ASIN list management with create, remove, and clear operations
- **NEW FEATURE**: Import/Export ASIN Lists
  - Added export functionality to share ASIN lists in JSON format
  - Export single selected list or all lists at once
  - Implemented smart import with conflict resolution options:
    - Merge: Combine imported ASINs with existing lists (no duplicates)
    - Replace: Overwrite existing lists with imported data
    - Skip: Only import non-conflicting lists
  - JSON format ensures compatibility and easy sharing between users
  - Export includes list metadata (descriptions, ASIN counts)
- **NEW FEATURE**: Edit List Tab for Advanced List Management
  - Added dedicated "Edit List" tab in ASIN Manager for comprehensive editing
  - Implemented list renaming capability with duplicate name validation
  - Added description editing with real-time updates
  - Created ASIN viewer showing all ASINs in selected list with count display
  - Implemented multi-select ASIN removal (using EXTENDED selectmode)
  - Added single ASIN addition with validation and duplicate checking
  - Auto-refresh functionality keeps Edit List tab synchronized with other operations
  - Handles edge cases when lists are renamed or deleted from other tabs
- **UI IMPROVEMENTS**: Enhanced user interface and usability
  - Doubled main menu window size from 500x500 to 1000x1000 for better visibility
  - Added prominent Submit button within batch processing frame for improved workflow
  - Removed exit confirmation dialog for smoother application closure
  - Enhanced batch mode with dedicated submit button after load operations
  - Improved button placement and layout consistency across all windows
  - Larger text areas in ASIN Manager for better usability
- **MAIN MENU**: Expanded unified application interface
  - Integrated "Current Buybox Owners" button with descriptive tooltip
  - Added "ASIN Manager" button for centralized list management
  - Maintained consistent design pattern across all tools
  - Added proper error handling and user feedback for all operations
  - Implemented return-to-menu workflow after completion
- **CODE QUALITY**: Architecture improvements and maintainability
  - Extended BuyboxAnalyzer class with new methods following existing patterns
  - Centralized ASIN management functions for reuse across application
  - Maintained Single Responsibility Principle across all modules
  - Added comprehensive error handling for API failures, file I/O, and edge cases
  - Implemented consistent data structure returns for easy integration
  - Enhanced import functionality with intelligent conflict resolution

## 2025-01-27
- **NEW FEATURE**: Implemented batch processing functionality for multiple ASINs
  - Added "Batch Processing" mode alongside existing "Single ASIN" mode
  - Created large text area for entering multiple ASINs (comma, space, or newline separated)
  - Added "Load All Saved ASINs" and "Load from List" quick-load buttons for batch input
  - Implemented progress tracking with visual progress bar and status updates
  - Added comprehensive error handling for individual ASIN processing failures
  - Enhanced results display to show batch analysis with grouped results by ASIN
  - Updated CSV export to handle multiple ASIN results in a single file
- **UI IMPROVEMENTS**: Enhanced ASIN Manager with multiple named lists
  - Increased ASIN Manager window size to 800x600 for better visibility
  - Implemented tabbed interface (Notebook) with "Add ASINs", "Manage Lists", and "All ASINs" tabs
  - Added support for multiple named ASIN lists with descriptions
  - Created list management features: create, remove, and clear lists
  - Added real-time synchronization between ASIN Manager and main application
  - Implemented immediate UI updates when ASINs are added/removed from lists
- **UI FIXES**: Resolved window positioning and layout issues
  - Fixed manual input field being disabled when "Manual Input" was selected
  - Added dynamic window sizing (600x600 for single mode, 600x700 for batch mode)
  - Centered "Select List" dialog window on screen instead of top-left corner
  - Centered "Processing ASINs" progress window on screen
  - Fixed submit button visibility in batch processing mode
- **CODE QUALITY**: Improved application architecture and user experience
  - Separated single ASIN and batch processing logic for better maintainability
  - Added comprehensive input validation for batch ASIN processing
  - Implemented proper error handling and user feedback throughout the application
  - Enhanced ASIN validation with detailed error messages for invalid ASINs
  - Added keyboard shortcuts (Enter to submit, Escape to cancel)

## 2025-08-04
- **NEW FEATURE**: Created `sales_rank_analyzer.py` - A comprehensive sales rank analysis tool
  - Added `SalesRankAnalyzer` class following Single Responsibility Principle
  - Implemented sales rank history fetching from Keepa API using correct `salesRanks` field
  - Added intelligent category selection algorithm to choose the most relevant sales rank data
  - Created GUI interface for user input (ASIN, days to analyze, export options)
  - Added comprehensive statistics calculation (average, min, max, rank changes)
  - Implemented CSV export functionality for sales rank history
  - Added robust error handling and input validation
- **BUG FIX**: Corrected sales rank data parsing
  - Fixed incorrect use of `csv` field (price data) instead of `salesRanks` field
  - Implemented proper category selection algorithm to identify best sales rank category
  - Added scoring system to prefer categories with lower average ranks and more data points
  - Resolved data structure parsing issues with Keepa API response format
- **DOCUMENTATION**: Updated README.md with sales rank analyzer documentation
  - Added explanation of Keepa API limitations for category-level data
  - Documented individual product sales rank analysis capabilities
  - Updated usage instructions for both buybox tracker and sales rank analyzer
- **CODE QUALITY**: Improved project structure and maintainability
  - Separated concerns between buybox analysis and sales rank analysis
  - Added comprehensive comments and documentation
  - Implemented consistent error handling patterns
  - Added temporary debug capabilities (commented out for production use)

## 2025-07-21
- Project created: Keepa API Buybox Tracker.
- Added `.env` file for Keepa API key management.
- Created `requirements.txt` with dependencies: requests, python-dotenv, pandas.
- Developed initial Python script to fetch buybox history and calculate Amazon's buybox percentage for a selected month and ASIN.
- Fixed bug: Convert buybox history timestamps to integer for correct datetime conversion.
- Corrected Amazon seller ID to `ATVPDKIKX0DER`.
- Added debug output to inspect DataFrame and seller IDs.
- Added tkinter popup for user input (ASIN, year, month).
- Added option to save DataFrame to CSV via file dialog.
- Made file export optional (user chooses via popup).
- Enhanced script to allow calculation of buybox % for multiple months in one API call (user enters months as comma-separated values).
- Improved user experience with popups for all major inputs and options.
- Created `README.md` and `CHANGELOG.md` files documenting project purpose and changes.